<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Orders</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

  <h2 class="mb-4">My Orders</h2>
  
  <table class="table table-bordered" id="ordersTable">
    <thead class="table-dark">
      <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Price (â‚¹)</th>
        <th>Status</th>
         <th>Date</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="orderList">
      <!-- Orders will load here -->
    </tbody>
  </table>

  <script>
async function loadOrders() {
  const res = await fetch("http://localhost:8080/api/orders");
    // const res = await fetch("https://ecommerce-backend-wnu9.onrender.com/api/orders");
  const orders = await res.json();

  let orderList = document.getElementById("orderList");
  orderList.innerHTML = "";

  if (orders.length === 0) {
    orderList.innerHTML = `<tr><td colspan="5" class="text-center">No orders found</td></tr>`;
    return;
  }

  orders.forEach(order => {
    orderList.innerHTML += `
      <tr>
        <td>${order.productName}</td>
        <td>${order.quantity}</td>
        <td>${order.price}</td>
        <td>${order.orderDate}</td>
        <td>${order.status}</td>
        <td>
          <button class="btn btn-sm btn-primary" onclick="downloadInvoice('${order.id}')">
            Download Invoice
          </button>
        </td>
      </tr>
    `;
  });
}

    function downloadInvoice(orderId) {
      // Open PDF in new tab or trigger download
      window.open(`http://localhost:8080/api/orders/${orderId}/invoice`, "_blank");
      // window.open(`https://ecommerce-backend-wnu9.onrender.com/api/orders/${orderId}/invoice`, "_blank");
    }

    // Load orders when page opens
    loadOrders();
  </script>

</body>
</html>
